{% extends base.html %}

{% block title %}Transaction{% end %}

{% block content %}
<div class="row">
    <div class="col-md-2">
        <a id="backLink"><span class="btn btn-primary btn-xs"><i class="fa fa-chevron-circle-left"></i> Go Back To Transaction Log</span></a>
    </div>
</div>
<br />
<div class="row">
    <div class="col-md-6">
        <div class="panel panel-default">
            <div class="panel-heading">Raw Request</div>
            <div id="raw_request" class="panel-body">
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="panel panel-default">
            <div class="panel-heading">Raw Response Headers</div>
            <div id="raw_response_headers" class="panel-body">
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <div class="panel panel-default">
            <div id="raw_response_body_heading" class="panel-heading">Raw Response Body</div>
            <div id="raw_response_body" class="panel-body">
            </div>
        </div>
    </div>
</div>
<script>
var mySpace = {
                    transaction_api_url:"{{ transaction_api_url }}",
                    transaction_log_url:"{{ transaction_log_url }}"
                  };
function displayTransaction(){
    $.getJSON( mySpace.transaction_api_url, function(obj){
            $("#raw_request").html((obj.raw_request).replace("\r\n","<br />","g"));
            $("#raw_response_headers").html(obj.response_headers.replace("\r\n","<br />","g"));
            $("#raw_response_body").text(obj.response_body);
            if (obj.binary_response){
                $("#raw_response_body_heading").html("Raw Response Body <span class='label label-default'>BASE64 Encoded</span>");
            }else{
                $("#raw_response_body_heading").html("Raw Response Body");
            }
        });
}
$(document).ready(function() {
        displayTransaction();
        $('#backLink').attr("href", mySpace.transaction_log_url);
});
</script>
{% end %}
